# فصل ششم: برنامه‌نویسی تابعی

متغیرها در زبان‌های تابعی تغییر نمی‌کنند 

‫بدون تغییر متغیرها دیگر race condition, deadlock, concurrent update problem نداریم 

- اگر حافظه نامحدود بود نیازی به تغییر آن نداشتیم
    
    مثلا: هر چیزی که بهمون میرسه بنویسیم و بعد روی تاریخ گزارش بگیریم (فقط آخرین نوشته‌ها رو لیست کنیم). در این حالت هیچ چیز تغییر نمی‌کنه. پایین‌تر می‌بینیم که هر چی حافظه بیشتری داشته باشیم می‌تونیم به این بهینگی نزدیک بشیم
    

**تفکیک تغییرپذیری**

‫اپلیکیشن یا سرویس‌های داخل اپلیکیشن به کامپوننت‌های immutable و mutable تفکیک می‌شوند

کامپوننت‌های تغییرناپذیر با یک یا دو کامپوننت که به طور کامل عملکردی نیستند و اجازه‌ی تغییر وضعیت می‌دهند مرتبط هستند

کامپوننت‌های مجاز به تغییر وضعیت به حافظه‌ای تراکنشی متصل هستند که مشکلات همروندی مثل به‌روزرسانی موازی یا شرایط مسابقه ایجاد نشود

شرایط مسابقه: race condition

وضعیت: state

**Event Sourcing**

‫هر چه RAM بیشتری داشته باشیم کمتر به mutable state نیاز داریم

برای مثال در سیستمی که تراکنش‌های مالی انجام می‌دهد، به جای نگهداری موجودی حساب، کافی‌ست لیست تراکنش‌ها ذخیره شود، آنگاه کافیست جمع تراکنش‌ها را حساب کنیم تا موجودی حاصل شود. عملا وضعیت را تغییر نداده‌ایم، اما تغییراتی که نیاز بوده ذخیره کرده‌ایم

‫این ایده‌ی Event sourcing است

‫عملا اپلیکیشن‌ها دیگر CRUD نیستند، بلکه CR هستند. پس دیگر مشکل به‌روزرسانی موازی نداریم

- اگر این ایده مزخرف به نظر می‌رسه:
    
    همین الان در گیت همین کار رو می‌کنیم