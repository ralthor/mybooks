# ‫فصل بیست و نهم: معماری Embedded تمیز

- ‫در سیستم‌های Embedded تاثیر سخت‌افزار و firmware روی نرم‌افزار زیاد است. حتی شرایطی وجود دارد که ممکن است در زمان تولید نرم‌افزار هنوز firmware وجود نداشته باشد، و البته بعد از تولید هم خطاهایی در آن وجود دارد که در نظر گرفتن آن ممکن است منجر به پیچیدگی روال طراحی شود.
- ‫عملا نرم‌افزاری که برای سیستم embedded ساخته می‌شود وابستگی زیادی به سخت‌افزار دارد
- ‫تا حد امکان باید از قرار دادن همه‌چیز در firmware اجتناب کرد و پیاده‌سازی را در نرم‌افزار انجام داد که بتواند چرخه‌ی زندگی سودمند و طولانی داشته باشد.
- ‫یک نقل قول از Kent Beck برای تولید نرم‌افزار آورده که شامل سه فعالیت برای ساخت نرم‌افزاره:
    1. جوری بسازش که کار کنه
    2. درستش کن (احتمالا با ریفکتورینگ و کد تمیز)
    3. سریعش کن. این شامل بهینه‌سازی قسمت‌های ضروری میشه
    - نکته
        
        قصد داشتم این نقل قول رو نقد کنم، اما توضیحی که بعدش داده و در مورد ریزبهینه‌سازی (که عملا فقط‫ وقت‌کشی هست و ارزشی ایجاد نمی‌کنه) صحبت کرده جوابم رو داد 😂
        

- سخت‌افزار با آماده نبودن و خطاهایی که ممکنه داشته باشه می‌تونه به گلوگاه تولید سیستم تبدیل بشه
- اما این باعث نمیشه که نتونیم اصول مطرح شده در این کتاب رو روش پیاده کنیم

### ‫معماری embedded تمیز یک معماری embedded قابل تست است

- اولین گام ایجاد لایه است. برای شروع سه لایه
    - نرم‌افزار
    - firmware
    - سخت‌افزار
- وقتی جدا شدند، می‌توانیم به سخت‌افزار به صورت «جزئیات» نگاه کنیم. پس به آن وابسته نمی‌شویم
- ‫بین firmware و نرم‌افزار یک لایه‌ی مجردسازی سخت‌افزار قرار می‌دهیم
    - HAL: Hardware Abstraction Layer

### ‫جزئیات سخت‌افزار را برای کاربر HAL فاش نکنید

- ‫یک معماری embedded تمیز خارج از سخت‌افزارش هم قابل تست است
- پردازنده و سیستم عامل هم جزئیات هستند
    - با لایه‌هایی این‌ها را هم مجرد می‌کنیم

### برنامه‌نویسی برای اینترفیس‌ها و قابلیت جایگزینی

- توصیه به رعایت اصول تولید نرم‌افزار تمیز و تفکیک دغدغه‌ها